<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Floor List</title>
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <style>
        body{
            font-family:sans-serif;
        }
        table, th, td {
            border-collapse: collapse;
            border: 0px solid black;
        }
        table {
            width: 100%;
        }
        th, td {
            width: 30%;
            /* border-bottom: 1px solid #dddddd; */
            border: 1px solid #ddd;
            
            padding: 8px;
        
        }

        .room-num{
            text-align:center;
        }

        th {
            padding: 15px;
            font-size: 20px;
            background-color:orange;
            text-align:center;
            color:black;
        }

        h2 {
            text-align: center;
            padding: 25px;
            font-size: 50px;
            font-family: "Gill Sans";
        }
        @page {
            size: portrait;
        }
    </style>
</head>
<body>
    <h2></h2>
    <table>
        <!-- <thead class="thead-dark"> -->
        <tr>
            <th>First Name</th>
            <th>Last Name</th>
            <th class="room-num">Room Number</th>
        </tr>
        <!-- </thead> -->
        <!-- <tr>
            <td id="first"></td>
            <td id="last"></td>
            <td id="room"></td>
        </tr> -->
    </table>
<script>
    $(document).ready(function() {
        var params = [];
        var objects = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
        for(var i = 0; i < objects.length; i++)
        {
            elements = objects[i].split('=');
            params.push(elements[1]);
        }
        var building = params[0].split("+")[0];
        var floor = params[0].split("+")[1];
        $("h2").append(building + " " + floor);
        if (params[3] === 'list') {
            $.getJSON("api/students/"+building+"/"+floor+"/", function (data, status, xhr) {
                if (status >= 400) return alert("ERROR : " + xhr.responseText);
                $.each(data.results, function (key, val) {
                    $("table").append(
                        "<tr>" +
                            "<td>"+val.name_first+"</td>"+
                            "<td>"+val.name_last+"</td>"+
                            "<td class=\"room-num\">"+val.floor_and_room+"</td>"+
                        "</tr>"
                    );
                    // $("#first").append(val.name_first + "<br />");
                    // $("#last").append(val.name_last + "<br />");
                    // $("#room").append(val.floor_and_room + "<br />");
                });
                window.print();
            });
        }
    });
</script>

</body>
</html>