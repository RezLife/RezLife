{{#section 'head'}}
<!-- stuff/css stylesheets that goes in head: -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
{{/section}}

{{#section 'script'}}
<!-- javascript files that go in the bottom html: -->

<!-- Script for successful upload message for upload roster-->
<script>
    $("#edit").click(function(){
        $.get("/demo_test.txt", {name:"ASher"}, function(data, status){
            alert("Data: " + data + "\nStatus: " + status);
        });
    });
    $("#upload").submit(function (event) {

        //stop submit the form, we will post it manually.
        event.preventDefault();

        // Get form
        var form = $('#upload')[0];

		    // Create an FormData object
        var data = new FormData(form);

		    // disabled the submit button
        $("#chart_upload").prop("disabled", true);

        $.ajax({
            type: "POST",
            enctype: 'multipart/form-data',
            url: "/resapp/upload",
            data: data,
            processData: false,
            contentType: false,
            cache: false,
            timeout: 600000,
            success: function (data, status, xhr) {
                alert("SUCCESS : " + xhr.responseText);
                $("#chart_upload").prop("disabled", false);
            },
            error: function (xhr) {
                alert("ERROR : " + xhr.responseText);
                $("#chart_upload").prop("disabled", false);
            }
        });
    });
    $("#add-student").submit(function (event) {

        //stop submit the form, we will post it manually.
        event.preventDefault();

        // Get form
        var form = $('#add-student')[0];

        // Create a FormData object
        var data = new FormData(form);
        console.log(data.get('name_first'));
        // disable the submit button until server confirmation
        $("#add-student").prop("disabled", true);

        var url = 'api/students/add';

        url += '/' + data.get('name_first');
        url += '/' + data.get('name_last');
        url += '/' + data.get('name_preferred');
        url += '/' + data.get('email');
        url += '/' + data.get('studentID');
        url += '/' + data.get('date_of_birth');
        url += '/' + data.get('year');
        url += '/' + data.get('classification_description');
        url += '/' + data.get('state_province');
        url += '/' + data.get('city');
        url += '/' + data.get('room_space_description');

        console.log(url);

        $.ajax({
            type: "GET",
            //enctype: 'multipart/form-data',
            url: url,
            data: null,
            //processData: false,
            //contentType: false,
            cache: false,
            timeout: 600000,
            success: function (data, status, xhr) {
                alert("SUCCESS : " + xhr.responseText);
                $("#add-student").prop("disabled", false);
            },
            error: function (xhr) {
                alert("ERROR : " + xhr.responseText);
                $("#add-student").prop("disabled", false);
            }
        });
  
        //$.ajax({
        //    type: "POST",
        //    enctype: 'multipart/form-data',
        //    url: 'add/student',
        //    data: data,
        //    processData: false,
        //    contentType: false,
        //    cache: false,
        //    timeout: 600000,
        //    success: function (data, status, xhr) {
        //        alert("SUCCESS : " + xhr.responseText);
        //        $("#add-student").prop("disabled", false);
        //    },
        //    error: function (xhr) {
        //        alert("ERROR : " + xhr.responseText);
        //        $("#add-student").prop("disabled", false);
        //    }
        //});
    });
    // $("#print_chart").submit(function (event) {
    //
    //     //stop submit the form, we will post it manually.
    //     event.preventDefault();
    //
    //     // Get form
    //     var form = $('#print_chart')[0];
    //
    //     // Create a FormData object
    //     var data = new FormData(form);
    //
    //     // disable the submit button until server confirmation
    //     $("#print_chart").prop("disabled", true);
    //
    //     var url = "floorlist";
    //     $.each(form, function (key, val) {
    //         alert(key + val);
    //     });
    //
    //     window.open('floorlist');
    //
    //     // $.ajax({
    //     //     type: "GET",
    //     //     //enctype: 'multipart/form-data',
    //     //     url: "/resapp/printlist",
    //     //     data: data,
    //     //     // processData: false,
    //     //     // contentType: false,
    //     //     cache: false,
    //     //     timeout: 600000,
    //     //     success: function (data, status, xhr) {
    //     //         window.open('floorlist');
    //     //         $("#print_chart").prop("disabled", false);
    //     //     },
    //     //     error: function (xhr) {
    //     //         alert("ERROR : " + xhr.responseText);
    //     //         $("#print_chart").prop("disabled", false);
    //     //     }
    //     // });
    // });
    // $("#print_chart").click(function () {
    //     $.get('floorlist', function (data, status) {
    //         var list = window.open('floorlist');
    //         list.document.(data);
    //     })
    //     window.open('floorlist');
    // });

</script>
<script src="js/accounts.js"></script>
{{/section}} 

{{!-- Actual Content --}}
<div class="content-wrapper">
  <div class="container-fluid">
    <!-- Breadcrumbs-->
    <ol class="breadcrumb">
      <li class="breadcrumb-item">
        <a href="home">Home</a>
      </li>
      <li class="breadcrumb-item active">Roster</li>
    </ol>
    <div class="row">
      <div class="col-12">
        <div class="card mb-3">
          <div class="card-header">
            <i class="fa fa-upload"></i> Upload new student chart
          </div>
          <div class="card-body">
            <!--the upload form-->
            <form id="upload" action="upload" method="post" enctype="multipart/form-data">
              Dorm:
              <select name="dorm">
                <option value="smithtraber">Smith-Traber</option>
                <option value="fischer">Fischer</option>
                <option value="macevans">MacEvans</option>
                <option value="williston">Williston</option>
                <option value="apartments">Apartments</option>
                <option value="houses">Houses</option>
              </select>
              <br> Semester:
              <select name="semester">
                <option value="fall">Fall</option>
                <option value="spring">Spring</option>
              </select>
              <!--The number field has a min, max, and a pattern that only allows integers.-->
              <input type="number" name="year" value="2017" min="1950" max="3000" pattern="\d*">
              <br> Floor chart:
              <input type="file" class="btn" name="chartupload">
              <br>
              <input type="submit" class="btn" value="Upload" id="chart_upload">
            </form>
          </div>
        </div>
        <div class="card mb-3">
          <div class="card-header">
            <i class="fa fa-print"></i> Print Chart
          </div>
          <div class="card-body">
              <form id="print_chart" action="floorlist" target="_blank">
                  Dorm:
                  <select name="dorm">
                      <option value="Traber 2">Traber 2</option>
                      <option value="Traber 3">Traber 3</option>
                      <option value="Traber 4">Traber 4</option>
                      <option value="Traber 5">Traber 5</option>
                      <option value="Traber 6">Traber 6</option>
                      <option value="Traber 7">Traber 7</option>
                      <option value="Smith 1S">Smith 1S</option>
                      <option value="Smith 2S">Smith 2S</option>
                      <option value="Smith 2E">Smith 2E</option>
                      <option value="Smith 3S">Smith 3S</option>
                      <option value="Smith 3E">Smith 3E</option>
                      <option value="Fischer 2E">Fischer 2E</option>
                      <option value="Fischer 3E">Fischer 3E</option>
                      <option value="Fischer 4E">Fischer 4E</option>
                      <option value="Fischer 5E">Fischer 5E</option>
                      <option value="Fischer 3S">Fischer 3S</option>
                      <option value="Fischer 4S">Fischer 4S</option>
                      <option value="Fischer 5S">Fischer 5S</option>
                      <option value="Fischer 1W">Fischer 1W</option>
                      <option value="Fischer 2W">Fischer 2W</option>
                      <option value="Fischer 3W">Fischer 3W</option>
                      <option value="Fischer 4W">Fischer 4W</option>
                      <option value="Fischer 5W">Fischer 5W</option>
                  </select>
                  <br> Semester:
                  <select name="semester">
                      <option value="fall">Fall</option>
                      <option value="spring">Spring</option>
                  </select>
                  <br> Year:
                  <!--The number field has a min, max, and a pattern that only allows integers.-->
                  <input type="number" name="year" value="2017" min="1950" max="3000" pattern="\d*">
                  <br>
                  <input type="radio" name="form" value="list" checked> List<br>
                  <input type="radio" name="form" value="chart"> Chart<br>
                  <input type="submit" value="Print" class="btn">
              </form>
          </div>
        </div>
        <div class="card mb-3">
          <div class="card-header">
            <i class="fa fa-edit"></i> Edit
          </div>
          <div class="card-body">
            <button id="edit" class="btn">Edit</button>
            <button id="add_student" data-toggle="modal" data-target="#addModal" class="btn">Add student</button>
            <button id="search" class="btn">Search</button>
          </div>
          <!--<div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>-->
        </div>
        <!--<h1>Blank</h1>-->
        <!--<p>This is an example of a Roster that you can use as a starting point for creating new ones.</p>-->
      </div>
    </div>
  </div>
</div>

<!-- Edit Student Modal -->
<div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="addModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addModalLabel">Add a student to the roster</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
              <form class="form-horizontal" id="add-student">
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">First Name:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" name="name_first" placeholder="Enter first name">
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">Last Name:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" name="name_last" placeholder="Enter last name">
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">Preferred Name:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" name="name_preferred" placeholder="Enter preferred name">
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="email">Email:</label>
                  <div class="col-sm-9">
                    <input type="email" class="form-control" name="email" placeholder="Enter email">
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">Student ID number:</label>
                  <div class="col-sm-9">
                    <input type="number" class="form-control" name="studentID" placeholder="Enter ID">
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">Date of Birth:</label>
                  <div class="col-sm-9">
                    <input type="date" class="form-control" name="date_of_birth">
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">Year:</label>
                  <div class="col-sm-9">
                    <select class="form-control" name="year">
                      <option value="1">Freshman</option>
                      <option value="2">Sophomore</option>
                      <option value="3">Junior</option>
                      <option value="4">Senior</option>
                    </select>
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">Classification:</label>
                  <div class="col-sm-9">
                    <select class="form-control" name='classification_description'>
                      <option value="1">New Freshman</option>
                      <option value="2">Continuing 2nd Year</option>
                      <option value="3">Returning 2nd Year</option>
                      <option value="4">Transfer 2nd Year</option>
                      <option value="5">Continuing 3-5</option>
                      <option value="6">Returning 3-5</option>
                      <option value="7">Transfer 3-5</option>
                    </select>
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">State<br>(two letters):</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" id="state" name="state_province" pattern="[A-Z]{2}" placeholder="Enter State of origin">
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">City:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" id="city" name="city" placeholder="Enter city of origin">
                  </div>
                </div>
                <div class="form-row">
                  <label class="control-label col-sm-3" for="">Room Space Description:</label>
                  <div class="col-sm-9">
                    <input type="text" class="form-control" name="room_space_description" pattern="[A-Z]{5} .*" placeholder="Enter roon space description">
                  </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                <input type="submit" class="btn btn-primary" value="Add" id="add-submit">
                </form>
            </div>
        </div>
    </div>
</div>